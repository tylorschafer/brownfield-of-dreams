<section class="dashboard-main">
  <section class='dashboard-top'>
    <h1> <%= current_user.first_name %>'s Dashboard </h1>
    <h3>Active: <%= current_user.active %></h3>
    <%= button_to 'Log Out', logout_path, method: 'delete', class: "btn btn-primary mb1 bg-teal" %>
    <h4>Account Details</h4>
      <h5><%= current_user.first_name  %> <%= current_user.last_name %></h5>
      <h5><%= current_user.email%></h5>
    <section>
      <h4>Bookmarked Segments</h4>
    </section>
    <section>
      <%= link_to 'Send an Invite', invite_path %>
    </section>
  </section>
  <% if current_user.gh_token %>
  <section class= 'friends'>
    <h3>Your Friends</h3>
    <% current_user.friends.each do |friend| %>
        <%= friend.first_name %>
        <%= friend.last_name %>
    <% end %>
  </section>
    <section id= 'gh-grid'>
      <h3 id='gh-title'>Github</h3>
      <section class= 'repos'>
        <table class= 'github'>
          <tr>
            <th>Repos</th>
          </tr>
          <% facade.repos.each do |repo| %>
            <tr>
              <td><%= link_to repo.name, repo.html_url %></td>
            </tr>
          <% end %>
      </table>
      </section>
      <section class= 'followers'>
        <table class= 'github'>
          <tr>
            <th colspan="2">Followers</th>
          </tr>
        <% facade.following.each do |user| %>
        <section id= 'gh_user-<%= user.name %>'>
          <tr>
            <td><%= image_tag user.picture, class: 'profile-image' %></td>
            <td><p><%= link_to user.name, user.link %></p></td>
            <% if facade.find_user(user.name) %>
              <td><p><%= link_to "Add as Friend", users_friend_path(friend_id: facade.user_id(user.name)), method: :post %></p></td>
            <% end %>
          </tr>
        </section>
        <% end %>
      </table class= 'github'>
      </section>
      <section class= 'following'>
        <table class= 'github'>
          <tr>
            <th colspan="2">Following</th>
          </tr>
        <% facade.followers.each do |user| %>
          <tr>
            <td><%= image_tag user.picture, class: 'profile-image' %></td>
            <td><p><%= link_to user.name, user.link %></p></td>
            <% if facade.find_user(user.name) %>
              <td><p><%= link_to "Add as Friend", users_friend_path(friend_id: facade.user_id(user.name)), method: :post %></p></td>
            <% end %>
          </tr>
        <% end %>
      </table>
      </section>
    </section>
    <% else %>
      <%= link_to "Connect to Github", "/auth/github", method: :get, class: "btn btn-primary mb1 bg-teal" %>
  <% end %>
</section>
